# v0.5.0 Pre-Release Checklist

**Status:** Version updated, documentation complete
**Date:** November 1, 2025

## âœ… Completed

- [x] Update all version strings to 0.5.0
  - [x] `src/srd_builder/__init__.py` â†’ 0.5.0
  - [x] `pyproject.toml` â†’ 0.5.0
  - [x] `build.py` FORMAT_VERSION â†’ v0.5.0
  - [x] `indexer.py` format_version â†’ v0.5.0
  - [x] `README.md` build pipeline section â†’ v0.5.0
  - [x] `SCHEMAS.md` builder_version â†’ 0.5.0
  - [x] `scripts/package_bundle.sh` â†’ v0.5.0
- [x] Create comprehensive release notes (v0.5.0_RELEASE_NOTES.md)
- [x] Regenerate production bundle with v0.5.0 metadata
- [x] Git tag v0.5.0 created
- [x] Commit version updates

## ğŸ”´ Critical (Must Fix Before Release)

### 1. Equipment Validation Script
**Priority:** HIGH
**Effort:** 1-2 hours
**Goal:** Boost confidence from 85% to 90%+

Create `scripts/validate_equipment.py` to spot-check items against SRD PDF:

```python
# Test cases to validate:
- [ ] 10 random gear items (rope, backpack, torch, etc.)
- [ ] Ammunition quantities (arrows should be 20, not 1)
- [ ] Mount/vehicle pricing
- [ ] Trade goods table entries
- [ ] Weapon properties edge cases (loading, reach, two-handed)
- [ ] Fractional weights (acid vial 1/2 lb)
```

**Acceptance Criteria:**
- At least 20 items manually validated against PDF
- Document any discrepancies found
- Update known issues in release notes if needed

### 2. Shield Subcategory Fix
**Priority:** MEDIUM
**Effort:** 15 minutes
**Issue:** Shield showing `sub_category="medium"` instead of `null` or `"shield"`

**Solution:**
Update `_infer_armor_subcategory()` in `parse_equipment.py`:
```python
if name_lower == "shield":
    return None  # or return "shield" if we want specific category
```

## ğŸŸ¡ Important (Should Fix)

### 3. Documentation Updates
**Priority:** MEDIUM
**Effort:** 30 minutes

- [ ] Update ROADMAP.md with v0.5.0 completion status
- [ ] Add equipment dataset examples to SCHEMAS.md
- [ ] Update docs/DATA_DICTIONARY.md with equipment fields
- [ ] Review and update COVERAGE_ANALYSIS.md

### 4. Weapon Subcategory Normalization
**Priority:** LOW
**Effort:** 1 hour
**Issue:** Weapon subcategories using raw strings ("Martial Melee") instead of normalized ("martial_melee")

**Impact:** Cosmetic, doesn't affect functionality but improves consistency

### 5. Properties Array Normalization
**Priority:** LOW
**Effort:** 1-2 hours
**Issue:** Properties currently raw strings ("Versatile (1d10)") instead of structured arrays

**Future Schema:**
```json
"properties": [
  "versatile",
  "finesse"
],
"versatile_damage": {"dice": "1d10"}
```

## ğŸ”µ Strategic (Future Work)

### 6. Table Metadata Discovery (Phase 0.5)
**Priority:** HIGH (for v0.6.0)
**Effort:** 2-3 hours
**Recommendation:** Do this BEFORE next dataset (spells/classes)

**Rationale:**
- Current heuristic approach works but doesn't scale
- Armor subcategory fix using name-based inference is pragmatic but highlights underlying issue
- PDF table layouts are complex, context tracking unreliable
- Would provide deterministic column mapping and validation

**Implementation:**
1. Create `discover_tables()` function to scan PDF
2. Generate `table_metadata.json` with headers, positions, context
3. Update extractors to use metadata for column mapping
4. Add validation: compare extracted items to table row counts

**Benefits:**
- Prevents future cycles of per-table debugging
- Enables validation ("did we extract all tables?")
- Documents PDF structure for future maintainers
- Makes column mapping deterministic

## ğŸ“‹ Testing Checklist

Before final release:

```bash
# Run all tests
pytest -q

# Run pre-commit checks
make pre-commit

# Validate schemas
python -m srd_builder.validate --ruleset srd_5_1

# Build fresh bundle
make bundle

# Verify version in output
jq '._meta.generated_by' dist/srd_5_1/data/equipment.json
# Should show: "srd-builder v0.5.0"

# Verify item counts
jq '.items | length' dist/srd_5_1/data/equipment.json
# Should show: 111

# Spot-check key items
jq '.items[] | select(.name=="Longsword")' dist/srd_5_1/data/equipment.json
jq '.items[] | select(.name=="Leather")' dist/srd_5_1/data/equipment.json
jq '.items[] | select(.name=="Plate")' dist/srd_5_1/data/equipment.json
```

## ğŸ¯ Minimum for Release

To ship v0.5.0 to Blackmoor:

1. âœ… Version updates (DONE)
2. âœ… Release notes documentation (DONE)
3. âœ… Regenerate bundle with v0.5.0 (DONE)
4. ğŸ”´ Equipment validation script (20 item spot-check)
5. ğŸŸ¡ Shield subcategory fix
6. ğŸŸ¡ Update ROADMAP.md

**Estimated time to minimum viable release:** 2-3 hours

## ğŸš€ Recommended for Quality Release

Add to minimum:

7. ğŸŸ¡ Complete documentation updates
8. ğŸŸ¡ Weapon subcategory normalization
9. ğŸ”µ Table metadata discovery planning document

**Estimated time to quality release:** 4-5 hours

## ğŸ“ Release Process

Once checklist complete:

1. Run full test suite and validation
2. Generate final bundle: `make bundle`
3. Create tarball: `cd dist && tar -czf srd-builder-output-v0.5.0.tar.gz srd_5_1/`
4. Update v0.5.0 git tag if needed: `git tag -f v0.5.0 -m "Updated message"`
5. Push to GitHub: `git push origin main --tags`
6. Copy bundle to Blackmoor distribution location
7. Update Blackmoor integration to use v0.5.0

## ğŸ”— Related Documents

- [v0.5.0_RELEASE_NOTES.md](./v0.5.0_RELEASE_NOTES.md) - Comprehensive release documentation
- [ROADMAP.md](./ROADMAP.md) - Project roadmap and milestones
- [SCHEMAS.md](./SCHEMAS.md) - Schema documentation
- [equipment_tables_plan/](./equipment_tables_plan/) - Table discovery planning
