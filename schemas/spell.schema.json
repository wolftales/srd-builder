{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://wolftales.github.io/srd-builder/schemas/spell.schema.json",
  "version": "2.0.0",
  "last_modified": "2025-12-23",
  "title": "Spell",
  "type": "object",
  "additionalProperties": true,
  "required": [
    "id",
    "simple_name",
    "name",
    "level",
    "school",
    "casting",
    "duration",
    "components",
    "description",
    "page"
  ],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^spell:[a-z0-9_]+$",
      "description": "Stable identifier for the spell entry (spell:<simple_name>)"
    },
    "simple_name": {
      "type": "string",
      "pattern": "^[a-z0-9_]+$",
      "description": "Normalized identifier without the entity prefix"
    },
    "aliases": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "uniqueItems": true,
      "description": "Alternative names or search terms for this spell"
    },
    "name": {
      "type": "string",
      "minLength": 1,
      "description": "Display name of the spell"
    },
    "level": {
      "type": "integer",
      "minimum": 0,
      "maximum": 9,
      "description": "Spell level (0 = cantrip, 1-9 = spell levels)"
    },
    "classes": {
      "type": "array",
      "items": {
        "type": "string",
        "enum": [
          "bard",
          "cleric",
          "druid",
          "paladin",
          "ranger",
          "sorcerer",
          "warlock",
          "wizard"
        ]
      },
      "description": "Classes that can cast this spell (if specified in SRD)"
    },
    "school": {
      "type": "string",
      "enum": [
        "abjuration",
        "conjuration",
        "divination",
        "enchantment",
        "evocation",
        "illusion",
        "necromancy",
        "transmutation"
      ],
      "description": "School of magic"
    },
    "casting": {
      "type": "object",
      "required": [
        "time",
        "range",
        "ritual"
      ],
      "additionalProperties": false,
      "properties": {
        "time": {
          "type": "string",
          "minLength": 1,
          "description": "Casting time (e.g., '1 action', '1 bonus action', '1 minute')"
        },
        "range": {
          "type": "object",
          "description": "Spell range and targeting information",
          "required": [
            "type"
          ],
          "additionalProperties": false,
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "self",
                "touch",
                "ranged",
                "sight",
                "unlimited"
              ],
              "description": "Targeting mechanism - how you select the target"
            },
            "distance": {
              "type": "object",
              "description": "How far the spell can be cast (for ranged spells)",
              "required": [
                "value",
                "unit"
              ],
              "additionalProperties": false,
              "properties": {
                "value": {
                  "type": "integer",
                  "minimum": 0,
                  "description": "Numeric distance value"
                },
                "unit": {
                  "type": "string",
                  "enum": [
                    "feet",
                    "miles"
                  ],
                  "description": "Unit of measurement"
                }
              }
            },
            "area": {
              "type": "object",
              "description": "Area of effect (for AOE spells like 'Self (15-foot cone)')",
              "required": [
                "shape",
                "size"
              ],
              "additionalProperties": false,
              "properties": {
                "shape": {
                  "type": "string",
                  "enum": [
                    "radius",
                    "sphere",
                    "cone",
                    "cube",
                    "line",
                    "cylinder"
                  ],
                  "description": "Shape of the affected area"
                },
                "size": {
                  "type": "object",
                  "description": "Dimensions of the area",
                  "required": [
                    "value",
                    "unit"
                  ],
                  "additionalProperties": false,
                  "properties": {
                    "value": {
                      "type": "integer",
                      "minimum": 0,
                      "description": "Size value"
                    },
                    "unit": {
                      "type": "string",
                      "enum": [
                        "feet",
                        "miles"
                      ],
                      "description": "Unit of measurement"
                    }
                  }
                }
              }
            }
          }
        },
        "ritual": {
          "type": "boolean",
          "description": "Whether the spell can be cast as a ritual"
        }
      },
      "description": "Casting mechanics"
    },
    "duration": {
      "type": "object",
      "required": [
        "requires_concentration",
        "length"
      ],
      "additionalProperties": false,
      "properties": {
        "requires_concentration": {
          "type": "boolean",
          "description": "Whether the spell requires concentration to maintain"
        },
        "length": {
          "type": "string",
          "minLength": 1,
          "description": "Duration of the spell (e.g., 'instantaneous', 'up to 1 minute', '1 hour', 'until dispelled')"
        }
      },
      "description": "Duration information including concentration requirements"
    },
    "components": {
      "type": "object",
      "required": [
        "verbal",
        "somatic",
        "material"
      ],
      "additionalProperties": false,
      "properties": {
        "verbal": {
          "type": "boolean",
          "description": "Verbal component required"
        },
        "somatic": {
          "type": "boolean",
          "description": "Somatic component required"
        },
        "material": {
          "type": "boolean",
          "description": "Material component required"
        },
        "material_description": {
          "type": "string",
          "minLength": 1,
          "description": "Description of required material component"
        }
      },
      "description": "Spell components (V/S/M)"
    },
    "effects": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "damage": {
          "type": "object",
          "required": [
            "dice",
            "type",
            "type_id"
          ],
          "additionalProperties": false,
          "properties": {
            "dice": {
              "type": "string",
              "pattern": "^\\d+d\\d+(\\s*[+\\-]\\s*\\d+)?$",
              "description": "Damage dice (e.g., '8d6', '1d10+5')"
            },
            "type": {
              "type": "string",
              "enum": [
                "acid",
                "bludgeoning",
                "cold",
                "fire",
                "force",
                "lightning",
                "necrotic",
                "piercing",
                "poison",
                "psychic",
                "radiant",
                "slashing",
                "thunder"
              ],
              "description": "Damage type"
            },
            "type_id": {
              "type": "string",
              "pattern": "^[a-z_]+$",
              "description": "Normalized damage type identifier for cross-referencing"
            }
          },
          "description": "Damage dealt by the spell"
        },
        "healing": {
          "type": "object",
          "oneOf": [
            {
              "required": [
                "dice"
              ],
              "additionalProperties": false,
              "properties": {
                "dice": {
                  "type": "string",
                  "pattern": "^\\d+d\\d+(\\s*[+\\-]\\s*\\d+)?$",
                  "description": "Healing dice (e.g., '2d8+5')"
                }
              }
            },
            {
              "required": [
                "amount"
              ],
              "additionalProperties": false,
              "properties": {
                "amount": {
                  "type": "integer",
                  "minimum": 1,
                  "description": "Fixed healing amount (e.g., 70)"
                }
              }
            },
            {
              "required": [
                "condition"
              ],
              "additionalProperties": false,
              "properties": {
                "condition": {
                  "type": "string",
                  "description": "Conditional healing description (e.g., 'half the necrotic damage dealt')"
                }
              }
            }
          ],
          "description": "Healing provided by the spell (dice-based, fixed amount, or conditional)"
        },
        "save": {
          "type": "object",
          "required": [
            "ability",
            "on_success"
          ],
          "additionalProperties": false,
          "properties": {
            "ability": {
              "type": "string",
              "enum": [
                "strength",
                "dexterity",
                "constitution",
                "intelligence",
                "wisdom",
                "charisma"
              ],
              "description": "Ability score for saving throw"
            },
            "on_success": {
              "type": "string",
              "enum": [
                "none",
                "half",
                "negates",
                "other"
              ],
              "description": "Effect on successful save"
            }
          },
          "description": "Saving throw required"
        },
        "attack": {
          "type": "object",
          "required": [
            "type"
          ],
          "additionalProperties": false,
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "melee_spell",
                "ranged_spell"
              ],
              "description": "Type of spell attack"
            }
          },
          "description": "Spell attack details"
        },
        "area": {
          "type": "object",
          "required": [
            "shape",
            "size",
            "unit"
          ],
          "additionalProperties": false,
          "properties": {
            "shape": {
              "type": "string",
              "enum": [
                "sphere",
                "cube",
                "cone",
                "line",
                "cylinder"
              ],
              "description": "Area of effect shape"
            },
            "size": {
              "type": "integer",
              "minimum": 0,
              "description": "Size of area (radius for sphere, length for line/cone, etc.)"
            },
            "unit": {
              "type": "string",
              "enum": [
                "feet"
              ],
              "description": "Unit of measurement"
            }
          },
          "description": "Area of effect"
        },
        "conditions": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^[a-z_]+$"
          },
          "description": "Status conditions applied by the spell"
        }
      },
      "description": "Spell effects (damage, healing, saves, etc.)"
    },
    "scaling": {
      "type": "object",
      "required": [
        "type",
        "formula"
      ],
      "additionalProperties": false,
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "slot",
            "character_level"
          ],
          "description": "Type of scaling: slot (upcast) or character_level (cantrip)"
        },
        "base_level": {
          "type": "integer",
          "minimum": 1,
          "maximum": 9,
          "description": "Base spell slot level for slot-type scaling"
        },
        "formula": {
          "type": "string",
          "minLength": 1,
          "description": "Human-readable scaling formula (e.g., '+1d6 per slot level above 3rd', '+1d10 at 5th, 11th, and 17th level')"
        }
      },
      "description": "How the spell scales (upcast or cantrip)"
    },
    "description": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1
      },
      "minItems": 1,
      "description": "Spell description as array of paragraph strings. Enables better text rendering (paragraphs, sections). Replaces 'text' field from v1.4.0."
    },
    "page": {
      "type": "integer",
      "minimum": 1,
      "description": "SRD page number"
    },
    "source": {
      "type": "string",
      "minLength": 1,
      "description": "Source identifier (e.g., 'SRD 5.1')"
    }
  }
}
