{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://wolftales.github.io/srd-builder/schemas/raw_monster.schema.json",
  "title": "Raw Monster Extraction",
  "description": "Verbatim PDF extraction output before parsing/normalization",
  "type": "object",
  "required": [
    "name",
    "pages",
    "blocks"
  ],
  "additionalProperties": true,
  "properties": {
    "name": {
      "type": "string",
      "minLength": 1,
      "description": "Monster name as it appears in PDF header"
    },
    "simple_name": {
      "type": "string",
      "pattern": "^[a-z0-9_]+$",
      "description": "Normalized identifier for lookups"
    },
    "pages": {
      "type": "array",
      "items": {
        "type": "integer",
        "minimum": 1
      },
      "minItems": 1,
      "uniqueItems": true,
      "description": "1-based page numbers where this monster appears"
    },
    "blocks": {
      "type": "array",
      "description": "Ordered text spans extracted from PDF",
      "items": {
        "type": "object",
        "required": [
          "page",
          "column",
          "bbox",
          "text"
        ],
        "additionalProperties": false,
        "properties": {
          "page": {
            "type": "integer",
            "minimum": 1,
            "description": "1-based page number"
          },
          "column": {
            "type": "integer",
            "minimum": 0,
            "description": "0=single column, 1=left, 2=right"
          },
          "bbox": {
            "type": "array",
            "items": {
              "type": "number"
            },
            "minItems": 4,
            "maxItems": 4,
            "description": "[x0, y0, x1, y1] in PDF points"
          },
          "text": {
            "type": "string",
            "description": "Raw text content from span"
          },
          "font": {
            "type": "string",
            "description": "Font name from PDF"
          },
          "size": {
            "type": "number",
            "description": "Font size in points"
          },
          "color": {
            "type": "array",
            "items": {
              "type": "integer",
              "minimum": 0,
              "maximum": 255
            },
            "minItems": 3,
            "maxItems": 3,
            "description": "[R, G, B] color values"
          },
          "flags": {
            "type": "integer",
            "description": "PyMuPDF text flags bitmask (bold, italic, etc.)"
          },
          "is_header": {
            "type": "boolean",
            "description": "True if this span is a monster name header"
          }
        }
      }
    },
    "markers": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Section keywords found (Armor Class, Actions, etc.)"
    },
    "warnings": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Extraction warnings (column_split_guess, missing_type_line, etc.)"
    },
    "_meta": {
      "type": "object",
      "description": "Optional extraction metadata for debugging"
    }
  }
}
